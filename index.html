<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wilderness Journey - Depths to Heights</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Georgia, serif;
            background: linear-gradient(135deg, #e8f0f2 0%, #d4e4e8 100%);
            color: #2c3e50;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            min-height: 100vh;
            background: white;
            position: relative;
            padding-bottom: 70px;
        }

        /* Screens */
        .screen {
            display: none;
            padding: 20px;
            animation: fadeIn 0.5s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #6b8e9f 0%, #8fa7b3 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
            margin: -20px -20px 20px -20px;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        /* Welcome Screen */
        .welcome-box {
            text-align: center;
            padding: 40px 20px;
        }

        .verse-box {
            background: #f8fbf8;
            border-left: 4px solid #7c9885;
            padding: 20px;
            margin: 30px 0;
            border-radius: 8px;
        }

        .verse-box p {
            font-style: italic;
            line-height: 1.6;
            color: #4a6572;
        }

        .verse-box cite {
            display: block;
            text-align: right;
            margin-top: 10px;
            color: #7c9885;
            font-weight: bold;
        }

        /* Buttons */
        .btn {
            background: linear-gradient(135deg, #7c9885 0%, #8fa49a 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 25px;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #94a5ab 0%, #a8b7bc 100%);
        }

        /* Menu Cards */
        .menu-card {
            background: white;
            border: 2px solid #e8eff1;
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .menu-card:active {
            transform: scale(0.98);
        }

        .menu-card h3 {
            color: #4a6572;
            margin-bottom: 8px;
            font-size: 20px;
        }

        .menu-card p {
            color: #6b8e9f;
            font-size: 14px;
            line-height: 1.4;
        }

        /* Mood Selection */
        .mood-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .mood-btn {
            background: #f7f9fa;
            border: 2px solid #e8eff1;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mood-btn:active {
            transform: scale(0.95);
        }

        .mood-btn.selected {
            background: linear-gradient(135deg, #8fa7b3 0%, #a2b8c2 100%);
            color: white;
            border-color: #6b8e9f;
        }

        .mood-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .mood-label {
            font-size: 14px;
            font-weight: 500;
        }

        /* Psalm Display */
        .psalm-box {
            background: linear-gradient(135deg, #f8fbf8 0%, #eef4ee 100%);
            border-left: 4px solid #7c9885;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .psalm-box h3 {
            color: #4a6572;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .psalm-text {
            font-size: 18px;
            line-height: 1.8;
            color: #5a6c75;
            font-style: italic;
            margin-bottom: 15px;
        }

        .psalm-reference {
            text-align: right;
            color: #7c9885;
            font-weight: bold;
        }

        /* Story Cards */
        .story-card {
            background: white;
            border: 1px solid #e8eff1;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .story-card:active {
            transform: scale(0.98);
        }

        .story-card h3 {
            color: #4a6572;
            margin-bottom: 10px;
            font-size: 20px;
        }

        .story-card p {
            color: #6b8e9f;
            line-height: 1.6;
            font-size: 14px;
        }

        .story-full {
            background: #f9fafb;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            line-height: 1.8;
            color: #4a6572;
        }

        /* Discipline Cards */
        .discipline-card {
            background: #fafbfc;
            border-left: 3px solid #8fa7b3;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .discipline-card h4 {
            color: #4a6572;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .discipline-card p {
            color: #6b8e9f;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .practice-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            font-style: italic;
            color: #5a6c75;
            margin-top: 10px;
        }

        /* Journal */
        .journal-area {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #d4e4e8;
            border-radius: 10px;
            font-family: Georgia, serif;
            font-size: 16px;
            line-height: 1.6;
            resize: vertical;
            background: white;
            color: #4a6572;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #6b8e9f 0%, #8fa7b3 100%);
            padding: 10px;
            display: flex;
            justify-content: space-around;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            max-width: 600px;
            margin: 0 auto;
        }

        .nav-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .nav-btn:active {
            transform: scale(0.95);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            padding: 20px;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal h2 {
            color: #4a6572;
            font-size: 24px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 28px;
            color: #6b8e9f;
            cursor: pointer;
        }

        .info-section {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e8eff1;
        }

        .info-section:last-child {
            border-bottom: none;
        }

        .info-section h3 {
            color: #4a6572;
            margin-bottom: 10px;
        }

        .info-section p {
            color: #6b8e9f;
            line-height: 1.6;
        }

        .crisis-note {
            background: #fff4e6;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #ff9800;
            margin: 20px 0;
        }

        .donation-section {
            background: #f0f7f2;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-top: 20px;
        }

        .donation-btn {
            background: linear-gradient(135deg, #7c9885 0%, #8fa49a 100%);
            color: white;
            padding: 12px 25px;
            border-radius: 20px;
            text-decoration: none;
            display: inline-block;
            margin-top: 10px;
        }

        /* Audio Toggle */
        .audio-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1001;
        }

        .audio-toggle.muted {
            background: #e5e7eb;
        }
    </style>
</head>
<body>
    <!-- Audio Toggle -->
    <div class="audio-toggle" id="audioToggle" onclick="toggleAudio()">
        <span id="audioIcon">🔊</span>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Welcome Screen -->
        <div class="screen active" id="welcomeScreen">
            <div class="header">
                <h1>Wilderness Journey</h1>
                <p>A companion through spiritual valleys</p>
            </div>
            
            <div class="welcome-box">
                <h2 style="color: #4a6572; margin-bottom: 20px;">You Are Not Alone</h2>
                
                <div class="verse-box">
                    <p>"Even though I walk through the valley of the shadow of death, I will fear no evil, for You are with me"</p>
                    <cite>- Psalm 23:4</cite>
                </div>
                
                <button class="btn" onclick="showScreen('mainMenu')">
                    Begin Your Journey
                </button>
            </div>
        </div>

        <!-- Main Menu -->
        <div class="screen" id="mainMenu">
            <div class="header">
                <h1>Wilderness Journey</h1>
                <p>Choose Your Path Today</p>
            </div>
            
            <div class="menu-card" onclick="showScreen('moodCheck')">
                <h3>🙏 Find Your Psalm</h3>
                <p>Match your current feelings with David's prayers</p>
            </div>
            
            <div class="menu-card" onclick="showScreen('storiesMenu')">
                <h3>📖 Wilderness Stories</h3>
                <p>Biblical heroes who faced dark valleys</p>
            </div>
            
            <div class="menu-card" onclick="showScreen('disciplinesMenu')">
                <h3>🕊️ Simple Practices</h3>
                <p>When faith feels impossible</p>
            </div>
            
            <div class="menu-card" onclick="showScreen('hopeScreen')">
                <h3>✨ Hope Reminders</h3>
                <p>God's promises for your wilderness</p>
            </div>
            
            <div class="menu-card" onclick="showScreen('journalScreen')">
                <h3>📝 Journal & Pray</h3>
                <p>Pour out your heart to God</p>
            </div>
        </div>

        <!-- Mood Check Screen -->
        <div class="screen" id="moodCheck">
            <div class="header">
                <h1>How Are You Today?</h1>
                <p>Be honest with God</p>
            </div>
            
            <div class="mood-grid">
                <div class="mood-btn" onclick="selectMood('darkness', this)">
                    <div class="mood-icon">🌑</div>
                    <div class="mood-label">In Deep Darkness</div>
                </div>
                <div class="mood-btn" onclick="selectMood('lost', this)">
                    <div class="mood-icon">🌫️</div>
                    <div class="mood-label">Lost & Confused</div>
                </div>
                <div class="mood-btn" onclick="selectMood('weary', this)">
                    <div class="mood-icon">😔</div>
                    <div class="mood-label">Weary & Tired</div>
                </div>
                <div class="mood-btn" onclick="selectMood('numb', this)">
                    <div class="mood-icon">💔</div>
                    <div class="mood-label">Numb & Empty</div>
                </div>
            </div>
            
            <button class="btn" onclick="showPsalm()">
                Show Me My Psalm
            </button>
            
            <button class="btn btn-secondary" onclick="showScreen('mainMenu')">
                Back to Menu
            </button>
        </div>

        <!-- Psalm Display Screen -->
        <div class="screen" id="psalmScreen">
            <div class="header">
                <h1>Your Psalm Today</h1>
                <p>David's prayer becomes yours</p>
            </div>
            
            <div class="psalm-box" id="psalmDisplay">
                <h3>A Prayer for Your Heart</h3>
                <div class="psalm-text">
                    "Out of the depths I cry to you, Lord; Lord, hear my voice."
                </div>
                <div class="psalm-reference">Psalm 130:1-2</div>
            </div>
            
            <div style="padding: 20px; background: #f9fafb; border-radius: 10px; margin: 20px 0;">
                <h4 style="color: #4a6572; margin-bottom: 10px;">Reflect:</h4>
                <p style="color: #6b8e9f; line-height: 1.6;">
                    David knew your pain. He cried these same tears. God heard him, and He hears you too.
                </p>
            </div>
            
            <button class="btn" onclick="getNewPsalm()">
                Another Psalm
            </button>
            
            <button class="btn btn-secondary" onclick="showScreen('moodCheck')">
                Change Mood
            </button>
            
            <button class="btn btn-secondary" onclick="showScreen('mainMenu')">
                Back to Menu
            </button>
        </div>

        <!-- Stories Menu -->
        <div class="screen" id="storiesMenu">
            <div class="header">
                <h1>Wilderness Stories</h1>
                <p>You're not the first to walk this path</p>
            </div>
            
            <div class="story-card" onclick="showStory('elijah')">
                <h3>🔥 Elijah's Depression</h3>
                <p>When the prophet wanted to die</p>
            </div>
            
            <div class="story-card" onclick="showStory('david')">
                <h3>🎵 David in the Cave</h3>
                <p>Hiding in darkness, writing psalms</p>
            </div>
            
            <div class="story-card" onclick="showStory('jesus')">
                <h3>✝️ Jesus in the Desert</h3>
                <p>40 days of testing and hunger</p>
            </div>
            
            <div class="story-card" onclick="showStory('job')">
                <h3>💔 Job's Suffering</h3>
                <p>When everything was taken</p>
            </div>
            
            <button class="btn btn-secondary" onclick="showScreen('mainMenu')">
                Back to Menu
            </button>
        </div>

        <!-- Story Display Screen -->
        <div class="screen" id="storyScreen">
            <div class="header">
                <h1 id="storyTitle">Story Title</h1>
                <p>God was there in their wilderness</p>
            </div>
            
            <div class="story-full" id="storyContent">
                Story content will appear here
            </div>
            
            <div class="psalm-box">
                <h3>What This Means for You:</h3>
                <p id="storyLesson" style="font-style: normal; color: #4a6572;">
                    God is with you just as He was with them.
                </p>
            </div>
            
            <button class="btn btn-secondary" onclick="showScreen('storiesMenu')">
                Back to Stories
            </button>
        </div>

        <!-- Simple Disciplines Menu -->
        <div class="screen" id="disciplinesMenu">
            <div class="header">
                <h1>When Faith Feels Impossible</h1>
                <p>Gentle practices for hard days</p>
            </div>
            
            <div class="discipline-card">
                <h4>🙏 The One-Word Prayer</h4>
                <p>When you can't find words</p>
                <div class="practice-box">
                    Simply whisper:<br>
                    "Help"<br>
                    "Please"<br>
                    "Jesus"<br>
                    That's enough. He hears.
                </div>
            </div>
            
            <div class="discipline-card">
                <h4>🌬️ The Three-Breath Practice</h4>
                <p>When anxiety overwhelms</p>
                <div class="practice-box">
                    Breathe in: "Lord..."<br>
                    Hold: "I need..."<br>
                    Breathe out: "You."<br>
                    Repeat until peace comes.
                </div>
            </div>
            
            <div class="discipline-card">
                <h4>☀️ The Morning Anchor</h4>
                <p>Before the day's weight</p>
                <div class="practice-box">
                    Hand on heart, say:<br>
                    "I am still loved today."<br>
                    Nothing changes this.<br>
                    Start here.
                </div>
            </div>
            
            <div class="discipline-card">
                <h4>🌙 The Evening Release</h4>
                <p>When sleep won't come</p>
                <div class="practice-box">
                    Name three burdens.<br>
                    Place them in God's hands.<br>
                    Say: "These are Yours tonight."<br>
                    Rest.
                </div>
            </div>
            
            <button class="btn btn-secondary" onclick="showScreen('mainMenu')">
                Back to Menu
            </button>
        </div>

        <!-- Hope Screen -->
        <div class="screen" id="hopeScreen">
            <div class="header">
                <h1>Remember: Dawn Is Coming</h1>
                <p>Every wilderness has an end</p>
            </div>
            
            <div class="psalm-box">
                <h3>God's Promise to You</h3>
                <div class="psalm-text">
                    "Weeping may stay for the night, but rejoicing comes in the morning."
                </div>
                <div class="psalm-reference">Psalm 30:5</div>
            </div>
            
            <div style="background: white; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3 style="color: #4a6572; margin-bottom: 15px;">Remember These Truths:</h3>
                <ul style="line-height: 2; color: #6b8e9f; padding-left: 20px;">
                    <li>This feeling is temporary, not permanent</li>
                    <li>You are loved beyond measure</li>
                    <li>Your life has purpose and meaning</li>
                    <li>God is working even when you can't see it</li>
                    <li>Many have walked this path and emerged stronger</li>
                    <li>Your story isn't over</li>
                </ul>
            </div>
            
            <div class="discipline-card">
                <h4>Hold On To This:</h4>
                <div class="practice-box">
                    "The God who brought you TO this wilderness<br>
                    is the same God who will lead you THROUGH it.<br>
                    He has not forgotten you.<br>
                    Morning is coming."
                </div>
            </div>
            
            <button class="btn btn-secondary" onclick="showScreen('mainMenu')">
                Back to Menu
            </button>
        </div>

        <!-- Journal Screen -->
        <div class="screen" id="journalScreen">
            <div class="header">
                <h1>Pour Out Your Heart</h1>
                <p>God collects every tear</p>
            </div>
            
            <div style="margin: 20px 0;">
                <h3 style="color: #4a6572; margin-bottom: 10px;">Write to God:</h3>
                <p style="color: #6b8e9f; margin-bottom: 15px;">
                    No perfect words needed. Just honesty.
                </p>
                <textarea class="journal-area" id="journalText" 
                    placeholder="Dear God, today I feel..."></textarea>
            </div>
            
            <button class="btn" onclick="saveJournal()">
                Save This Prayer
            </button>
            
            <div id="savedMessage" style="display: none; padding: 15px; background: #d4f1d4; border-radius: 8px; margin: 15px 0; text-align: center; color: #2d6a2d;">
                ✓ Your prayer has been saved
            </div>
            
            <button class="btn btn-secondary" onclick="showScreen('mainMenu')">
                Back to Menu
            </button>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <button class="nav-btn" onclick="showScreen('mainMenu')">🏠 Home</button>
        <button class="nav-btn" onclick="showScreen('moodCheck')">🙏 Psalm</button>
        <button class="nav-btn" onclick="showScreen('hopeScreen')">✨ Hope</button>
        <button class="nav-btn" onclick="showInfo()">ℹ️ Info</button>
        <button class="nav-btn" onclick="showAbout()">❤️ About</button>
    </div>

    <!-- Info Modal -->
    <div class="modal" id="infoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>About Wilderness Journey</h2>
                <button class="close-modal" onclick="closeModal('infoModal')">&times;</button>
            </div>
            
            <div class="info-section">
                <h3>What is this app?</h3>
                <p>A biblical companion for depression and spiritual darkness. Connect your feelings with Psalms, read wilderness stories, and find gentle practices for difficult days.</p>
            </div>

            <div class="info-section">
                <h3>How to Use</h3>
                <p>1. Select how you're feeling today<br>
                2. Read a Psalm that matches your mood<br>
                3. Explore stories of biblical heroes<br>
                4. Try simple spiritual practices<br>
                5. Journal your prayers</p>
            </div>

            <div class="info-section">
                <h3>Install on Phone</h3>
                <p><strong>iPhone:</strong> Tap share button → Add to Home Screen<br>
                <strong>Android:</strong> Tap menu (3 dots) → Add to Home Screen</p>
            </div>

            <div class="crisis-note">
                <strong>Crisis Support:</strong><br>
                If you are in crisis, please contact your local helpline for immediate support.
            </div>
        </div>
    </div>

    <!-- About Modal -->
    <div class="modal" id="aboutModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Depths to Heights</h2>
                <button class="close-modal" onclick="closeModal('aboutModal')">&times;</button>
            </div>
            
            <div class="info-section">
                <h3>Our Mission</h3>
                <p>Creating biblical tools for mental health support, bringing hope to those in life's valleys.</p>
            </div>

            <div class="info-section">
                <h3>Created By</h3>
                <p><strong>Made by Justin</strong><br>
                Depths to Heights<br>
                <a href="https://depthstoheights.org" style="color: #7c9885;">depthstoheights.org</a><br>
                <a href="mailto:depthstoheights@gmail.com" style="color: #7c9885;">depthstoheights@gmail.com</a></p>
            </div>

            <div class="donation-section">
                <h3>Support This Work</h3>
                <p>If this app has helped you, consider supporting our mission.</p>
                <a href="https://www.paypal.com/donate/?hosted_button_id=8GRE7B8C3TP2U" 
                   class="donation-btn" target="_blank">Donate via PayPal</a>
            </div>

            <div class="crisis-note">
                <strong>Remember:</strong><br>
                You are loved. You matter. Help is available.
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let selectedMood = null;
        let currentPsalmIndex = 0;
        let audioContext = null;
        let isPlaying = false;

        // Psalm Database
        const psalms = {
            darkness: [
                { text: "Out of the depths I cry to you, Lord; Lord, hear my voice. Let your ears be attentive to my cry for mercy.", ref: "Psalm 130:1-2" },
                { text: "My God, my God, why have you forsaken me? Why are you so far from saving me?", ref: "Psalm 22:1" },
                { text: "How long, Lord? Will you forget me forever? How long will you hide your face from me?", ref: "Psalm 13:1" },
                { text: "I am worn out from my groaning. All night long I flood my bed with weeping.", ref: "Psalm 6:6" },
                { text: "Save me, O God, for the waters have come up to my neck.", ref: "Psalm 69:1" }
            ],
            lost: [
                { text: "Send me your light and your faithful care, let them lead me.", ref: "Psalm 43:3" },
                { text: "Show me your ways, Lord, teach me your paths. Guide me in your truth.", ref: "Psalm 25:4-5" },
                { text: "You are my lamp, Lord; the Lord turns my darkness into light.", ref: "2 Samuel 22:29" },
                { text: "The Lord is my light and my salvation—whom shall I fear?", ref: "Psalm 27:1" },
                { text: "Your word is a lamp for my feet, a light on my path.", ref: "Psalm 119:105" }
            ],
            weary: [
                { text: "Come to me, all you who are weary and burdened, and I will give you rest.", ref: "Matthew 11:28" },
                { text: "I am worn out calling for help; my throat is parched.", ref: "Psalm 69:3" },
                { text: "My soul is weary with sorrow; strengthen me according to your word.", ref: "Psalm 119:28" },
                { text: "He gives strength to the weary and increases the power of the weak.", ref: "Isaiah 40:29" },
                { text: "Even youths grow tired and weary, but those who hope in the Lord will renew their strength.", ref: "Isaiah 40:30-31" }
            ],
            numb: [
                { text: "Why, my soul, are you downcast? Why so disturbed within me? Put your hope in God.", ref: "Psalm 42:11" },
                { text: "The Lord is close to the brokenhearted and saves those who are crushed in spirit.", ref: "Psalm 34:18" },
                { text: "My heart is blighted and withered like grass; I forget to eat my food.", ref: "Psalm 102:4" },
                { text: "Restore to me the joy of your salvation and grant me a willing spirit.", ref: "Psalm 51:12" },
                { text: "I have become like broken pottery.", ref: "Psalm 31:12" }
            ]
        };

        // Story Database
        const stories = {
            elijah: {
                title: "Elijah Under the Broom Tree",
                content: "After defeating 450 prophets of Baal, Elijah ran in fear from Queen Jezebel. Exhausted and depressed, he sat under a broom tree and prayed to die: 'I have had enough, Lord. Take my life.' But God didn't scold or abandon him. Instead, He sent an angel with bread and water, let him rest, and then spoke to him in a gentle whisper. God reminded Elijah he wasn't alone - 7,000 others hadn't bowed to Baal. Sometimes the greatest prophets have the darkest moments.",
                lesson: "God meets us in our exhaustion with tenderness, not judgment. He provides rest, nourishment, and reminds us we're never as alone as we think."
            },
            david: {
                title: "David in the Cave",
                content: "Hiding in the caves of Adullam and En Gedi, David was a fugitive running from King Saul. In these dark caves, feeling abandoned and afraid, David wrote some of his most powerful psalms. 'Look and see, there is no one at my right hand; no one is concerned for me. I have no refuge; no one cares for my life' (Psalm 142:4). Yet in that same psalm, he declares God as his refuge. The caves became his sanctuary.",
                lesson: "Your darkest places can become holy ground. God is present in the caves of life, and your honest cries become songs that help others."
            },
            jesus: {
                title: "Jesus in the Wilderness",
                content: "For 40 days, Jesus fasted in the desert. Hungry, alone, and tested by Satan himself. The Son of God experienced physical weakness, isolation, and spiritual attack. He knows what it's like to be tempted to give up, to take shortcuts, to doubt the Father's care. But He emerged 'in the power of the Spirit.' The wilderness wasn't punishment - it was preparation.",
                lesson: "Jesus understands your wilderness personally. He's been where you are. And just as the Father sent angels to minister to Him, help is coming for you too."
            },
            job: {
                title: "Job's Dark Night",
                content: "In a single day, Job lost everything - his children, wealth, and health. Sitting in ashes, scraping his sores with broken pottery, even his wife told him to 'curse God and die.' His friends accused him of hidden sin. For 37 chapters, Job wrestled with the question 'Why?' When God finally spoke, He didn't give answers but revealed Himself. Job's response: 'My ears had heard of you but now my eyes have seen you.' His story ends with double restoration.",
                lesson: "Sometimes there are no answers to 'why,' but God's presence is enough. What the enemy means for destruction, God uses for greater blessing."
            }
        };

        // Show screen function
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            setTimeout(() => {
                document.getElementById(screenId).classList.add('active');
            }, 100);
        }

        // Mood selection
        function selectMood(mood, element) {
            selectedMood = mood;
            document.querySelectorAll('.mood-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            element.classList.add('selected');
        }

        // Show psalm based on mood
        function showPsalm() {
            if (!selectedMood) {
                selectedMood = 'darkness';
            }
            currentPsalmIndex = 0;
            displayPsalm();
            showScreen('psalmScreen');
        }

        // Display current psalm
        function displayPsalm() {
            const moodPsalms = psalms[selectedMood] || psalms.darkness;
            const psalm = moodPsalms[currentPsalmIndex];
            
            document.getElementById('psalmDisplay').innerHTML = `
                <h3>A Prayer for Your Heart</h3>
                <div class="psalm-text">${psalm.text}</div>
                <div class="psalm-reference">${psalm.ref}</div>
            `;
        }

        // Get new psalm
        function getNewPsalm() {
            const moodPsalms = psalms[selectedMood] || psalms.darkness;
            currentPsalmIndex = (currentPsalmIndex + 1) % moodPsalms.length;
            displayPsalm();
        }

        // Show story
        function showStory(storyKey) {
            const story = stories[storyKey];
            document.getElementById('storyTitle').textContent = story.title;
            document.getElementById('storyContent').textContent = story.content;
            document.getElementById('storyLesson').textContent = story.lesson;
            showScreen('storyScreen');
        }

        // Save journal
        function saveJournal() {
            const text = document.getElementById('journalText').value;
            if (text) {
                // Save to localStorage
                const journals = JSON.parse(localStorage.getItem('wildernessJournals') || '[]');
                journals.push({
                    text: text,
                    date: new Date().toISOString()
                });
                localStorage.setItem('wildernessJournals', JSON.stringify(journals));
                
                // Show saved message
                document.getElementById('savedMessage').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('savedMessage').style.display = 'none';
                }, 3000);
            }
        }

        // Audio functions
        function toggleAudio() {
            const icon = document.getElementById('audioIcon');
            const toggle = document.getElementById('audioToggle');
            
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(174, audioContext.currentTime);
                gainNode.gain.setValueAtTime(0.02, audioContext.currentTime);
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                oscillator.start();
                
                isPlaying = true;
                icon.textContent = '🔊';
            } else if (isPlaying) {
                audioContext.suspend();
                isPlaying = false;
                icon.textContent = '🔇';
                toggle.classList.add('muted');
            } else {
                audioContext.resume();
                isPlaying = true;
                icon.textContent = '🔊';
                toggle.classList.remove('muted');
            }
        }

        // Modal functions
        function showInfo() {
            document.getElementById('infoModal').classList.add('active');
        }

        function showAbout() {
            document.getElementById('aboutModal').classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Close modal on background click
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });
    </script>
</body>
</html>
